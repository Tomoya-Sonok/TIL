# フロントエンドエンジニアとは？

ブラウザや Web サーバについて深い理解があり、
HTML, CSS, JavaScript を問題なく扱うことができてモダンな JS フレームワークにも精通している、そして、バックエンドの API との疎通も難なくできて、セキュリティやパフォーマンス等の非機能要件にもしっかり向き合って開発を進められるエンジニア。

（以下、古川陽介さんが[Youtube の動画](https://www.youtube.com/watch?v=6cgCmLf71og&list=PLyIMkawalXXny_aF6my8j2K37j7ra2gEy)で話されていたことをまとめた）

`ユーザー体験を向上させるエンジニア`のこと。

## MUST NOT（やってはいけないこと）

- ブラウザの体験を壊してはいけない
  - スクロール時にガタガタする
  - 戻る・進むボタンが機能しなくなる
  - 入力フォームで Enter 押しても送信できない

`最も原理的でかつ最大的に要求されること。`

## MUST（やらなければいけないこと）

- ブラウザについて知る、理解する
  - ブラウザの動き
    - 最初に HTML を読み込む
    - HTML 内にあるサブリソース（CSS, JavaScript, 画像やビデオ, etc..）
    - 読み込まれたリソースを基にレイアウトしてページをレンダリングする（初期表示）
    - JavaScript によって、初期表示後に動的にコンテンツを更新できる
- サーバについて知る、理解する
  - クライアントから要求してリソースやデータをやりとりする対象がサーバ
  - サーバに対してネットワーク接続を行い、データを転送する
  - HTTP のリクエストとレスポンスを基にページを更新する

`「動くからいい」ではなく、ブラウザの原理を知り、サーバの動きを理解した上でアプリケーションを作ろう`

## SHOULD（やるべきこと）

- 非機能要件に向き合う
  - セキュリティ
  - 性能
  - メンテナンサビリティ
  - アクセサビリティ

`パフォーマンスやセキュリティの技術は日進月歩で進んでいく。`見えないものは測れないので、ツールなどを利用して`見える化`していく。互いに教え合って`ノウハウを共有`することが重要。

## TO BE BETTER（やったほうがいいこと）

フロントエンドの知識は広くて深い。。。（実質、勉強すべきことは無限にある）  
無限の中で有限の処理をするのに必要なのは、`モチベーション`である。

【古川さんが勉強するうえで心がけていること】

- アプリケーションを作る
  - 1.なんか勉強する -> 2.作る -> 3.発表/公開する -> 4.フィードバックをもらう (1 に戻る)
  - とにかく`楽しむことが重要`！
- 知識に垣根を作らない
  - Backend / Frontend ではなく`Backend 💚 Frontend`
  - 理想は、I 字型でなく `T 字型`
  - `好奇心に垣根は作らない`ほうがいい

---

古川陽介氏  
【プロフィール】  
Japan Node.js Association 代表理事、日本最大の JavaScript カンファレンスである JSConf JP オーガナイザーなど、日本の JavaScript コミュニティを運営している。 Chrome 諮問委員会メンバー、 Node.js Core Collaborator など、ブラウザの中から OSS 開発まで幅広く活動している。  
twitter: https://twitter.com/yosuke_furukawa  
hatenablog: https://yosuke-furukawa.hatenablog.com/

---

# 非機能要件・パフォーマンスチューニング

## １. 現状のパフォーマンスを解析

まずは手始めに `Lighthouse` 等でパフォーマンス解析を行う。

Lighthouse は、ウェブページの品質改善の指針を「パフォーマンス」「PWA」「アクセシビリティ」「ベストプラクティス」「SEO」の観点でチェックしてくれるツール。

解析結果をうけて、画像の解像度や設定を最適化したり、HTML Living Standard の仕様に沿って semantic なコーディングを心がけることでパフォーマンス等のスコアを上げていくことが望ましい。ある程度の点数を取れているならば、無理に満点を目指すよりも、下記のような他の取り組みやその時点で優先度の高い課題に注力するのが better。

## ２. 優先度に応じたリソースの取得・実行

早期に取得したほうがよいリソースもあれば、処理を後回しにしてしまってもよいリソースもある。初期表示時には必要がなかったり、ページ表示後にバックグラウンドで処理すれば十分なものは意外と多い。そういったリソースの処理を後回しにすることで、重要度の高いリソースの処理を優先的に行うことができる。

- preload によるコンテンツの先読み  
  優先度の高いリソースの link タグは`rel="preload"` で強制的に先読みさせる。フォントやファーストビューで使われている画像は優先的に早期取得することで、不完全なコンテンツが表示されてしまう時間を減らすことができる。

- 画像の遅延ロード  
  スクロールしなければ表示されない画像については、取得を後回しにしても問題ない可能性がある。その際は img 要素の`loading属性`を使って読み込みタイミングを指定する。

- Dynamic Import を使う  
  すぐには使わないスクリプトや特定の条件でのみ使うことになるスクリプトは、`Dynamic Import` を使うことで任意のタイミングで読み込ませる。

## ３. ユーザー体験を悪化させない工夫

無限スクロールで無駄な計算処理を発生させてしまって画面がカタつくことや、画像のダウンロード前後で画像の付近のレイアウトが一瞬崩れる `Layout Shift`のような現象はユーザー体験に悪影響を及ぼすのでそうならないように工夫を施す必要がある。

- Layout Shift を防ぐ  
  img タグには属性で width や height を指定し、親要素の width と img タグのアスペクト比をスタイルで指定すれば、Layout Shift は未然に防ぐことができる。

- Flash of Unstyled Text (FOUT) や Flash of Invisible Text (FOIT) を防ぐ  
  `FOUT` は、ウェブフォントが適用される前のテキストが表示され、ウェブフォントが読み込まれると適用後のテキストに切り替わる現象。`FOIT` は、ウェブフォントが読み込まれるまでテキストが表示されない現象。

  ウェブフォントはファイルサイズが大きくダウンロードに時間がかかりやすいため、積極的にキャッシュを利用したり、使っているフォントだけを読み込むことで上記のような現象を抑えることができる。

## ４. 快適な UI をつくるために

ページの表示を高速化するだけでなく、ユーザーの操作に素早く反応し滑らかに動く UI を作ることも「パフォーマンス」の重要な要素である。

ブラウザが描画内容を更新することを「フレームを更新する」と呼び、1 秒間にフレームの更新が何回行われたかを示す単位は `fps`（frame per second）と呼ばれる。
そして、60 fps を実現できれば、つまり 1 秒間にフレームの更新を 60 回行えれば、滑らかな UI を実現できるとされている。
逆に fps が低い場合、例えば 1 秒間に数回しか表示が更新されないような状態だと、画面をスクロールした際などに強いカクつきを感じることになる。

60 fps を実現するためには、1 回のフレームの更新を 16.7 ミリ秒で終わらせる必要があるが、フレームを更新するためにブラウザが行わなければならない仕事は多く、16.7 ミリ秒以内で収めることは難しい。そのため、いかにしてブラウザの仕事を減らすかが重要になる。

## その他

HTTP ヘッダ を使ったキャッシュの活用や Web Storage についても時間を見つけて情報収集したい。。。
